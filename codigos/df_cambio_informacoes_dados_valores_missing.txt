# --- 2 Carregando Dataframe Taxa de Câmbio e obtendo informações quanto a valores missing ---
cambio_file = '/content/STP-20251001162317444_tx_cambio.csv'

metadados_cambio = {}
data_list = []
original_cambio_col_name = None

try:

    with open(cambio_file, 'r', encoding='latin1') as file:

        reader = csv.reader(file, delimiter=';')

        linha1 = next(reader)
        if len(linha1) > 1:
            original_cambio_col_name = linha1[1].strip()
        else:
            original_cambio_col_name = 'CAMBIO'

        linha2 = next(reader)

        try:
            next(reader)
        except StopIteration:
            pass

        metadados_cambio = {
            'nome_original': original_cambio_col_name,
            'unidade': linha2[1].strip() if len(linha2) > 1 else 'N/A'
        }

        for row in reader:
            if not row:
                continue

            if row[0].startswith('Fonte'):
                break

            if len(row) >= 2:
                data_list.append([row[0].strip(), row[1].strip()])


    df_cambio = pd.DataFrame(data_list, columns=['Data', original_cambio_col_name])

except Exception as e:
    print(f"Erro ao carregar e processar o dataset {cambio_file}: {e}")
    exit()

df_cambio['Data'] = pd.to_datetime(df_cambio['Data'], format='%d/%m/%Y', errors='coerce')
df_cambio[original_cambio_col_name] = df_cambio[original_cambio_col_name].str.replace(',', '.', regex=False)
df_cambio[original_cambio_col_name] = pd.to_numeric(df_cambio[original_cambio_col_name], errors='coerce')

print("--- Metadados Documentados ---")
print(f"Nome da Série Original: {metadados_cambio['nome_original']}")
print(f"Unidade de Medida: {metadados_cambio['unidade']}")
print("------------------------------")

print(f"\nPrimeiras 5 linhas do dataframe {cambio_file} CORRIGIDO:")
display(df_cambio.head())

print(f"\nInformações do dataframe {cambio_file} CORRIGIDO:")
df_cambio.info()
